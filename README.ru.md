# Downfall of Perception v0.7
Это игра, приключение в странном разрушающемся мире.
В некоторой степени это эксперимент с несколькими механиками, атмосферой, генерацией и линейным сюжетом.

Хоть игра вполне проходима до конца, я даю ей версию 0.7, оставляя место для правок контента, улучшений логики и баланса.

Скачать собранную игру можно [здесь](https://drive.google.com/file/d/1j7zAy8fXLOUsgPZcLH2C7GOkNd1oN9KV/view?usp=sharing)

### Вещи к которым я впервые прикоснулся работая над проектом:
* Система задач и достижений. Профили локаций.
* Гибкие предметы.
* Катсцены.
* Озвучка речи персонажей.
* Локализация.
* Сама генерация геометрии.

## Воксели
Когда я не знал о существовании VoxelTools, я писал свой однопоточный GDNative модуль. Он хорошо работал, и я бы мог продолжать его использовать, но я узнал про VoxelTools и захотел использовать терраформирование.  Терраформирование я в итоге не использовал, но VoxelTools мне понравился своей многопоточносью. Единственное, мне пришлось подредактировать модуль, я добавил виртуальную функцию в VoxelInstancer, для получения трансформации объекта на поверхности, чтобы можно было спавнить свои сцены, а не multimesh instances. Скомпилированный редактор я выкладывать не буду.

## Ошибки
Ошибки которые я совершил работая над проектом.
Их легко исправить, достаточно лишь уделить этому время. Чтобы не забыть, я опишу их тут.

### Файловая система
* Несогласованный нейминг файлов. Из-за того что я нигде не описал правила именования, я именовал их не строго.
* Несогласованная структура директорий. Сцены игровых объектов в файловой системе расположены достаточно хаотично, чтобы запутсться. Поиск по имени файла эту проблему решает, но для чистоты и организованности лучше располагать файлы так, чтобы было интуитивно понятно где что находится.
### Код
* Хардкод. В профилях локаций и в некоторых игровых объектах можно встретить литералы, выполняющие роль идентификатора какого-нибудь события или достижения. Это делает код хрупким.
* В начале работы над игрой я решил писать логику игровых объектов на GDScript, а основу для них на C# (смотреть классы ScriptedUsable, ScriptedWeapon). У меня просто мечта была создать свой скриптовой язык и кодить на нем объекты как в doom или garrys mod, но на практике оказалось, что это только усложняет работу.
* Есть некоторые проблемы в архитектуре и объекто-ориентированности.
### Ресурсы
* Слабые катсцены, у меня это просто анимация и звук. Некоторые события, вроде затемнения, тряски камеры и перехода на другую сцену, я осуществлял в коде профилей локаций. Нужно придумать оформление событий в проекте блендера и экспортировать их в сцены, наследующие класс Cutscene, где будут назначаться все события и их тайминги, которые преобразуются в кадры на дорожках анимации.
* При экспорте obj моделей, материалы экспортируются в SubResource, а при импорте glb godot создает отдельные SpatialMaterial ресурсы. Надо чтобы экспортер тоже создавал отдельные файлы для материалов.
* Непростой пайплайн у аудио ресурсов, постоянно экспортировать куски проекта из fl studio не удобно. Нужно что-то предпринять, я знаю что есть софт для саунд дизайнеров, но я сначала попробую написать свой инструмент.

### Немного видео
[![some video](https://img.youtube.com/vi/FNDD5uT6_58/0.jpg)](https://www.youtube.com/watch?v=FNDD5uT6_58)